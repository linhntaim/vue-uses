{"version":3,"sources":["../../../src/uses/i18n/locale-manager.js"],"names":["LocaleManager","app","importLocaleCallback","defaultLocale","loadedLocales","locale","Promise","resolve","i18n","$i18n","apply","$utils","log","ui","send","setLang","includes","then","m","setLocaleMessage","push"],"mappings":"0tBAAaA,CAAAA,a,yBACT,uBAAYC,GAAZ,CAAiBC,oBAAjB,CAA6D,IAAtBC,CAAAA,aAAsB,2DAAN,IAAM,qCACzD,KAAKF,GAAL,CAAWA,GAAX,CACA,KAAKG,aAAL,CAAqB,CAACD,aAAD,CAArB,CACA,KAAKD,oBAAL,CAA4BA,oBAC/B,C,0DAEGG,M,CAAQ,gBACR,MAAO,IAAIC,CAAAA,OAAJ,CAAY,SAAAC,OAAO,CAAI,CAC1B,GAAMC,CAAAA,IAAI,CAAG,KAAI,CAACP,GAAL,CAASQ,KAAtB,CAEA,GAAID,IAAI,CAACH,MAAL,GAAgBA,MAApB,CAA4B,CACxBE,OAAO,CAACF,MAAD,CAAP,CACA,MACH,CAED,GAAMK,CAAAA,KAAK,CAAG,QAARA,CAAAA,KAAQ,EAAM,sBACE,KAAI,CAACT,GAAL,CAASU,MADX,CACTC,GADS,kBACTA,GADS,CACJC,EADI,kBACJA,EADI,CAGhBD,GAAG,CAACE,IAAJ,CAAS,gBAAkBN,IAAI,CAACH,MAAvB,CAAgC,MAAhC,CAAyCA,MAAlD,CAA0D,QAA1D,EAEAG,IAAI,CAACH,MAAL,CAAcA,MAAd,CACAQ,EAAE,CAACE,OAAH,CAAWV,MAAX,EACA,MAAOA,CAAAA,MACV,CARD,CAUA,GAAI,KAAI,CAACD,aAAL,CAAmBY,QAAnB,CAA4BX,MAA5B,CAAJ,CAAyC,CACrCE,OAAO,CAACG,KAAK,CAACL,MAAD,CAAN,CAAP,CACA,MACH,CAED,KAAI,CAACH,oBAAL,CAA0BG,MAA1B,EAAkCY,IAAlC,CAAuC,SAAAC,CAAC,CAAI,CACxCV,IAAI,CAACW,gBAAL,CAAsBd,MAAtB,CAA8Ba,CAAC,WAA/B,EACA,KAAI,CAACd,aAAL,CAAmBgB,IAAnB,CAAwBf,MAAxB,EACAE,OAAO,CAACG,KAAK,CAACL,MAAD,CAAN,CACV,CAJD,CAKH,CA5BM,CA6BV,C","sourcesContent":["export class LocaleManager {\r\n    constructor(app, importLocaleCallback, defaultLocale = 'en') {\r\n        this.app = app\r\n        this.loadedLocales = [defaultLocale]\r\n        this.importLocaleCallback = importLocaleCallback\r\n    }\r\n\r\n    set(locale) {\r\n        return new Promise(resolve => {\r\n            const i18n = this.app.$i18n\r\n\r\n            if (i18n.locale === locale) {\r\n                resolve(locale)\r\n                return\r\n            }\r\n\r\n            const apply = () => {\r\n                const {log, ui} = this.app.$utils\r\n\r\n                log.send('changed from ' + i18n.locale + ' to ' + locale, 'locale')\r\n\r\n                i18n.locale = locale\r\n                ui.setLang(locale)\r\n                return locale\r\n            }\r\n\r\n            if (this.loadedLocales.includes(locale)) {\r\n                resolve(apply(locale))\r\n                return\r\n            }\r\n\r\n            this.importLocaleCallback(locale).then(m => {\r\n                i18n.setLocaleMessage(locale, m.default)\r\n                this.loadedLocales.push(locale)\r\n                resolve(apply(locale))\r\n            })\r\n        })\r\n    }\r\n}\r\n"],"file":"locale-manager.js"}