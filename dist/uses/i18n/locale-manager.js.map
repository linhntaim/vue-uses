{"version":3,"sources":["../../../src/uses/i18n/locale-manager.js"],"names":["LocaleManager","app","localePath","defaultLocale","loadedLocales","locale","Promise","resolve","i18n","$i18n","$utils","log","ui","apply","send","setLang","includes","then","m","setLocaleMessage","push"],"mappings":"42DAAaA,CAAAA,a,yBACT,uBAAYC,GAAZ,CAAiBC,UAAjB,CAAmD,IAAtBC,CAAAA,aAAsB,2DAAN,IAAM,qCAC/C,KAAKF,GAAL,CAAWA,GAAX,CACA,KAAKG,aAAL,CAAqB,CAACD,aAAD,CAArB,CACA,KAAKD,UAAL,CAAkBA,UACrB,C,0DAEGG,M,CAAQ,gBACR,MAAO,IAAIC,CAAAA,OAAJ,CAAY,SAAAC,OAAO,CAAI,CAC1B,GAAMC,CAAAA,IAAI,CAAG,KAAI,CAACP,GAAL,CAASQ,KAAtB,CAD0B,qBAER,KAAI,CAACR,GAAL,CAASS,MAFD,CAEnBC,GAFmB,kBAEnBA,GAFmB,CAEdC,EAFc,kBAEdA,EAFc,CAI1B,GAAIJ,IAAI,CAACH,MAAL,GAAgBA,MAApB,CAA4B,CACxBE,OAAO,CAACF,MAAD,CAAP,CACA,MACH,CAED,GAAMQ,CAAAA,KAAK,CAAG,QAARA,CAAAA,KAAQ,EAAM,CAChBF,GAAG,CAACG,IAAJ,CAAS,gBAAkBN,IAAI,CAACH,MAAvB,CAAgC,MAAhC,CAAyCA,MAAlD,CAA0D,QAA1D,EAEAG,IAAI,CAACH,MAAL,CAAcA,MAAd,CACAO,EAAE,CAACG,OAAH,CAAWV,MAAX,EACA,MAAOA,CAAAA,MACV,CAND,CAQA,GAAI,KAAI,CAACD,aAAL,CAAmBY,QAAnB,CAA4BX,MAA5B,CAAJ,CAAyC,CACrCE,OAAO,CAACM,KAAK,CAACR,MAAD,CAAN,CAAP,CACA,MACH,CAED,0BAAU,KAAI,CAACH,UAAf,aAA6BG,MAA7B,iEAAuCY,IAAvC,CAA4C,SAAAC,CAAC,CAAI,CAC7CV,IAAI,CAACW,gBAAL,CAAsBd,MAAtB,CAA8Ba,CAAC,WAA/B,EACA,KAAI,CAACd,aAAL,CAAmBgB,IAAnB,CAAwBf,MAAxB,EACAE,OAAO,CAACM,KAAK,CAACR,MAAD,CAAN,CACV,CAJD,CAKH,CA3BM,CA4BV,C","sourcesContent":["export class LocaleManager {\r\n    constructor(app, localePath, defaultLocale = 'en') {\r\n        this.app = app\r\n        this.loadedLocales = [defaultLocale]\r\n        this.localePath = localePath\r\n    }\r\n\r\n    set(locale) {\r\n        return new Promise(resolve => {\r\n            const i18n = this.app.$i18n\r\n            const {log, ui} = this.app.$utils\r\n\r\n            if (i18n.locale === locale) {\r\n                resolve(locale)\r\n                return\r\n            }\r\n\r\n            const apply = () => {\r\n                log.send('changed from ' + i18n.locale + ' to ' + locale, 'locale')\r\n\r\n                i18n.locale = locale\r\n                ui.setLang(locale)\r\n                return locale\r\n            }\r\n\r\n            if (this.loadedLocales.includes(locale)) {\r\n                resolve(apply(locale))\r\n                return\r\n            }\r\n\r\n            import(`${this.localePath}/${locale}`).then(m => {\r\n                i18n.setLocaleMessage(locale, m.default)\r\n                this.loadedLocales.push(locale)\r\n                resolve(apply(locale))\r\n            })\r\n        })\r\n    }\r\n}\r\n"],"file":"locale-manager.js"}